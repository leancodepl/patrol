---
title: V2 migration guide
---

# Migration guide to v2

Patrol v2 is the first new major version Patrol.

Unfortunately, some breaking changes couldn't be avoided, but they're rather
minor and mostly concern boilerplate and configuration files. The good news is
that code of tests written in Dart stays the same (with some exceptions).

## Android

### MainActivityTest.java

Contents of this file have to be replaced. It's located your application's
**android/app/src/androidTest/java/com/example/myapp/** directory (replacing
com, example, and myapp with values from your app's package name).

```java name="MainActivityTest.java"
package pl.leancode.patrol.example; // replace "pl.leancode.patrol.example" with your app's package

import org.junit.Test;
import org.junit.runner.RunWith;
import org.junit.runners.Parameterized;
import org.junit.runners.Parameterized.Parameters;
import pl.leancode.patrol.PatrolJUnitRunner;

@RunWith(Parameterized.class)
public class MainActivityTest {
    @Parameters(name = "{0}")
    public static Object[] testCases() {
        PatrolJUnitRunner.waitForPatrolAppService();
        return PatrolJUnitRunner.listDartTests();
    }

    public MainActivityTest(String dartTestName) {
        this.dartTestName = dartTestName;
    }

    private final String dartTestName;

    @Test
    public void runDartTest() {
        PatrolJUnitRunner.runDartTest(dartTestName);
    }
}
```

### build.gradle

A few changes are also needed in **app-level build.gradle**:

```diff title="android/app/build.gradle"
 android {
   // ...
   defaultConfig {
     //...
-    testInstrumentationRunner "androidx.test.runner.AndroidJUnitRunner"
+    testInstrumentationRunner "pl.leancode.patrol.PatrolJUnitRunner"
   }

+  testOptions {
+    execution "ANDROIDX_TEST_ORCHESTRATOR"
+  }
 }

 dependencies {
+  androidTestUtil "androidx.test:orchestrator:1.4.2"
 }
```

If you had `testImplementation "junit:junit:4.13.2"` or similar, it should be
removed.

## iOS
